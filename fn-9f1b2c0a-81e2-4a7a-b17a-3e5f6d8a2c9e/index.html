<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CTF #1 — Fortinet</title>
  <meta name="description" content="Mini-CTF: Reto 1 Fortinet — Encuentra la bandera en el código fuente.">
  <meta name="robots" content="noindex,nofollow">
  <style>
    :root{
      --bg-card:rgba(10,14,20,.8);
      --text:#e6edf3;
      --accent-strong:#00ff9f;
      --border:rgba(255,255,255,.12);
    }
    html,body{height:100%}
    body{
      margin:0;color:var(--text);
      background:linear-gradient(135deg,#000 0%,#0b0f14 50%,#001a12 100%);
      background-size:300% 300%;animation:gradientMove 12s ease infinite;
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,"Cascadia Mono","Courier New",monospace;
      display:flex;align-items:center;justify-content:center;padding:24px;min-height:100vh;
    }
    @keyframes gradientMove{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
    body::before{
      content:"";position:fixed;inset:0;pointer-events:none;z-index:1;
      background:repeating-linear-gradient(rgba(0,229,143,0.04) 0px,rgba(0,229,143,0.04) 1px,transparent 2px,transparent 4px);
    }
    .wrap{
      width:min(700px,100%);position:relative;z-index:2;border-radius:18px;border:1px solid var(--border);
      background:var(--bg-card);box-shadow:0 8px 30px rgba(0,0,0,.28),inset 0 0 0 1px rgba(0,255,159,.05);padding:22px;
    }
    h1{margin:0 0 8px 0;text-transform:uppercase;letter-spacing:.06em;font-weight:900;font-size:clamp(24px,5vw,38px);color:var(--accent-strong);text-shadow:0 0 6px var(--accent-strong),0 0 14px rgba(0,229,143,.6)}
    p{margin:10px 0;color:#d6e8e0}
    .hint{color:#ffd36b;font-weight:700;margin-top:8px}
    .rule{color:#9fb0c3;font-size:13px;margin-top:8px}
    .form{display:grid;gap:10px;margin-top:16px;grid-template-columns:1fr 1fr auto;justify-items:center}
    label{font-size:12px;color:#bdebdc;letter-spacing:.02em;display:block;text-align:left;width:100%}
    input{width:80%;padding:8px 10px;border-radius:10px;border:1px solid rgba(0,255,159,.15);background:rgba(255,255,255,.05);color:var(--text);font-size:14px;text-align:center}
    button{padding:8px 14px;border-radius:10px;border:1px solid rgba(0,255,159,.35);background:rgba(0,255,159,.12);color:#e6fff5;font-weight:800;cursor:pointer;box-shadow:0 0 8px rgba(0,255,159,.2)}
    button:hover{background:rgba(0,255,159,.18)}
    .stand{font-size:13px;color:#c9f7e7;background:rgba(0,255,159,.10);border:1px dashed rgba(0,255,159,.35);padding:4px 8px;border-radius:999px;display:inline-block;margin-bottom:10px}
    @media (max-width:760px){.form{grid-template-columns:1fr}input{width:100%}button{width:100%}}
  </style>
</head>
<body>
  <main class="wrap" role="main" aria-labelledby="title">
    <span class="stand">Stand: Fortinet • Reto #1</span>
    <h1 id="title">Mini-CTF — Fortinet</h1>

    <p>La bandera está <strong>oculta en el código fuente</strong> de esta página.<br>Inspecciona el HTML y escribe la respuesta exactamente así: <code>FORTI-XXXX</code>.</p>
    <p class="hint">Pista: busca un comentario HTML.</p>
    <p class="rule">Formato a enviar: solo la cadena (ej. <code>FORTI-XXXX</code>). No compartas la solución públicamente.</p>

    <!-- BANDERA OCULTA (para quienes inspeccionan): -->
    <!!!!!!!!!!!!!!!!!-- FORTI-INSPECTOR !!!!!!!!!!!!!!!!!!!!!!!!-->

    <!-- FORMULARIO -->
    <form id="ctfForm" class="form" autocomplete="off">
      <div>
        <label for="alias">Alias</label>
        <input id="alias" name="alias" type="text" required pattern="^[A-Za-z0-9_-]{4,16}$" placeholder="tu_alias">
      </div>

      <div>
        <label for="flag">Respuesta</label>
        <input id="flag" name="flag" type="text" required placeholder="FORTI-XXXX">
      </div>

      <div style="display:flex;align-items:flex-end">
        <button type="submit">Enviar</button>
      </div>
    </form>
  </main>

  <script>
    // ENDPOINT de tu Apps Script (ya integrado)
    const ENDPOINT = 'https://script.google.com/macros/s/AKfycbyhoVZ3ahIsjke2m5Vvb4HJUOIHYoI7CDPAYpdWftTfhGzPxWf1JoWeyY41cDED132u/exec';
    const STATION_ID = 'fortinet-1';

    const form = document.getElementById('ctfForm');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const aliasEl = document.getElementById('alias');
      const flagEl  = document.getElementById('flag');

      const alias = aliasEl.value.trim();
      const flag  = flagEl.value.trim();

      if (!alias || !flag) {
        alert('Por favor completa alias y respuesta.');
        return;
      }

      const payload = { station_id: STATION_ID, alias, flag };

      try {
        const res = await fetch(ENDPOINT, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload),
          mode: 'cors'
        });
        const data = await res.json();

        if (!data.ok) {
          alert(data.msg || 'Error al registrar. Intenta de nuevo.');
          return;
        }

        if (data.correct) {
          alert(`✅ ¡Correcto! +${data.points} puntos.`);
        } else {
          alert('❌ Respuesta incorrecta. Intenta de nuevo.');
        }
      } catch (err) {
        console.error(err);
        alert('Error de red o servidor. Intenta más tarde.');
      }
    });
  </script>
</body>
</html>
