<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CTF #1 — Fortinet</title>
  <meta name="description" content="Mini-CTF: Reto 1 — Descubre el login correcto usando la pista." />
  <meta name="robots" content="noindex,nofollow">
  <style>
    :root{
      --bg-card:rgba(10,14,20,.8);
      --text:#e6edf3;
      --accent-strong:#00ff9f;
      --border:rgba(255,255,255,.12);
      --warn:#ffd36b;
      --muted:#9fb0c3;
      --ok:#5ee3a4;
      --err:#ff7b7b;
    }
    html,body{height:100%}
    body{
      margin:0;color:var(--text);
      background:linear-gradient(135deg,#000 0%,#0b0f14 50%,#001a12 100%);
      background-size:300% 300%;animation:gradientMove 12s ease infinite;
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,"Cascadia Mono","Courier New",monospace;
      display:flex;align-items:center;justify-content:center;padding:24px;min-height:100vh;
    }
    @keyframes gradientMove{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
    body::before{
      content:"";position:fixed;inset:0;pointer-events:none;z-index:1;
      background:repeating-linear-gradient(rgba(0,229,143,0.04) 0px,rgba(0,229,143,0.04) 1px,transparent 2px,transparent 4px);
    }
    .wrap{
      width:min(700px,100%);position:relative;z-index:2;border-radius:18px;border:1px solid var(--border);
      background:var(--bg-card);box-shadow:0 8px 30px rgba(0,0,0,.28),inset 0 0 0 1px rgba(0,255,159,.05);padding:22px;
    }
    h1{margin:0 0 8px 0;text-transform:uppercase;letter-spacing:.06em;font-weight:900;font-size:clamp(24px,5vw,38px);color:var(--accent-strong);text-shadow:0 0 6px var(--accent-strong),0 0 14px rgba(0,229,143,.6)}
    p{margin:10px 0;color:#d6e8e0;line-height:1.4}
    .hint{color:var(--warn);font-weight:700;margin-top:8px}
    .rule{color:var(--muted);font-size:13px;margin-top:8px}
    .form{
      display:grid;gap:10px;margin-top:16px;
      grid-template-columns:1fr 1fr auto;align-items:end;
    }
    label{font-size:12px;color:#cfe6dd;opacity:.9}
    input{
      width:100%;padding:12px 12px;border-radius:12px;border:1px solid var(--border);
      background:#0a1218;color:var(--text);outline:none;
    }
    input[readonly]{opacity:.85}
    input::placeholder{color:#8aa3a0}
    button{
      padding:12px 16px;border-radius:12px;border:1px solid var(--border);
      background:linear-gradient(180deg,#0f1e1a,#0b1613);color:var(--text);cursor:pointer;
      font-weight:800;letter-spacing:.03em;text-transform:uppercase;
      box-shadow:inset 0 0 0 1px rgba(0,255,159,.1);
    }
    button:hover{box-shadow:0 0 20px rgba(0,255,159,.12),inset 0 0 0 1px rgba(0,255,159,.2)}
    .status{margin-top:14px;font-size:14px}
    .ok{color:var(--ok)}
    .err{color:var(--err)}
    .flag{
      margin-top:16px;padding:14px;border:1px dashed rgba(0,255,159,.35);
      border-radius:12px;background:rgba(0,255,159,.06);color:#c9ffe8;font-weight:800;
      word-break:break-all
    }
    .footer{margin-top:14px;color:var(--muted);font-size:12px}
    @media (max-width:640px){
      .form{grid-template-columns:1fr;align-items:stretch}
      button{width:100%}
    }
  </style>
</head>
<body>
  <main class="wrap" role="main" aria-labelledby="title">
    <h1 id="title">CTF — Reto 1 (Fortinet)</h1>
    <p><strong>¿Cuál es el login de este portal?</strong><br>
      El usuario dejó el usuario: <strong>admin</strong>.<br>
      La contraseña es un número de <strong>4 dígitos</strong>.
    </p>
    <p class="hint">Pista: nacimiento de Fortinet</p>
    <p class="rule"></p>

    <form id="loginForm" class="form" autocomplete="off">
      <div>
        <label for="user">Alias: (tu alias aparecera en el ranking board)</label>
        <input id="user" name="user" type="text" value="admin" readonly aria-readonly="true">
      </div>
      <div>
        <label for="pass">Contraseña</label>
        <input id="pass" name="pass" type="tel" inputmode="numeric" pattern="\\d{4}" maxlength="4" placeholder="####" autocomplete="off" required>
      </div>
      <div>
        <button type="submit" aria-label="Probar login">Enviar</button>
      </div>
    </form>

    <div id="status" class="status" aria-live="polite"></div>
    <div id="flag" class="flag" style="display:none">HLMX{fortinet_2000}</div>

    <p class="footer"></p>
  </main>

  <script>

    const EXPECTED_HEX = "81a83544cf93c245178cbc1620030f1123f435af867c79d87135983c52ab39d9";

    async function sha256Hex(text){
      const enc = new TextEncoder().encode(text.trim());
      const buf = await crypto.subtle.digest('SHA-256', enc);
      const arr = Array.from(new Uint8Array(buf));
      return arr.map(b => b.toString(16).padStart(2,"0")).join("");
    }

    const form = document.getElementById('loginForm');
    const pass = document.getElementById('pass');
    const statusEl = document.getElementById('status');
    const flagEl = document.getElementById('flag');

    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      statusEl.textContent = "";
      flagEl.style.display = "none";

      const pwd = (pass.value || "").trim();

      if(!/^\d{4}$/.test(pwd)){
        statusEl.innerHTML = '<span class="err">Formato inválido. Deben ser 4 dígitos .</span>';
        return;
      }

      try{
        const hex = await sha256Hex(pwd);
        if(hex === EXPECTED_HEX){
          statusEl.innerHTML = '<span class="ok">¡Correcto! Credenciales válidas, obtuviste 500 puntos.</span>';
          flagEl.style.display = "block";
          // Opcional: aquí podrías hacer fetch() a tu backend para registrar solve
        }else{
          statusEl.innerHTML = '<span class="err">Respuesta incorrecta.</span>';
        }
      }catch(err){
        console.error(err);
        statusEl.innerHTML = '<span class="err">Ocurrió un error al verificar. Intenta de nuevo.</span>';
      }
    });

    // UX: enfocar contraseña al cargar
    window.addEventListener('DOMContentLoaded', () => pass.focus());
  </script>
</body>
</html>
